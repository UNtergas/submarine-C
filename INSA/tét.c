#include"interface.h"


void init_dessins_pieces(unsigned char d[][HAUTEUR_CASE][LARGEUR_CASE])
{
    int i,j;

    /**** PION *****/
    for(i=0;i<HAUTEUR_CASE-3;i++)
        for(j=0;j<LARGEUR_CASE;j++)
            d[0][i][j]=' ';
    for(j=0;j<(LARGEUR_CASE-3)/2;j++)
    {
        d[0][i][j]=' ';
        d[0][i][LARGEUR_CASE-1-j]=' ';
    }
    for(j=(LARGEUR_CASE-3)/2;j<(LARGEUR_CASE-3)/2+3;j++)
        d[0][i][j]=219;
    i++;
    for(j=0;j<(LARGEUR_CASE-3)/2;j++)
    {
        d[0][i][j]=' ';
        d[0][i][LARGEUR_CASE-1-j]=' ';
    }
    d[0][i][(LARGEUR_CASE-3)/2]=220;
    d[0][i][(LARGEUR_CASE-3)/2+1]=219;
    d[0][i][(LARGEUR_CASE-3)/2+2]=220;
    i++;
    d[0][i][0]=' ';
    d[0][i][LARGEUR_CASE-1]=' ';
    for(j=(LARGEUR_CASE-5)/2;j<(LARGEUR_CASE-5)/2+5;j++)
         d[0][i][j]=219;

    /**** CAVALIER *****/
     for(i=0;i<HAUTEUR_CASE-4;i++)
        for(j=0;j<LARGEUR_CASE;j++)
            d[1][i][j]=' ';
    for(j=0;j<(LARGEUR_CASE-4)/2;j++)
    {
        d[1][i][j]=' ';
        d[1][i][LARGEUR_CASE-1-j]=' ';
    }
    d[1][i][(LARGEUR_CASE-4)/2]=220;
    d[1][i][(LARGEUR_CASE-4)/2+1]=219;
    d[1][i][(LARGEUR_CASE-4)/2+2]=223;
    d[1][i][(LARGEUR_CASE-4)/2+3]=220;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[1][i][j]=' ';
        d[1][i][LARGEUR_CASE-1-j]=' ';
    }
    d[1][i][(LARGEUR_CASE-5)/2]=219;
    for(j=(LARGEUR_CASE-5)/2+1;j<(LARGEUR_CASE-5)/2+1+3;j++)
        d[1][i][j]=' ';
    d[1][i][j]=223;
    i++;
    for(j=0;j<(LARGEUR_CASE-3)/2;j++)
    {
        d[1][i][j]=' ';
        d[1][i][LARGEUR_CASE-1-j]=' ';
    }
    for(j=(LARGEUR_CASE-3)/2-1;j<(LARGEUR_CASE-3)/2+1;j++)
        d[1][i][j]=219;
    d[1][i][j]=220;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[1][i][j]=' ';
        d[1][i][LARGEUR_CASE-1-j]=' ';
    }
    d[1][i][j++]=220;
    for(;j<(LARGEUR_CASE-5)/2+4;j++)
        d[1][i][j]=219;
     d[1][i][j]=220;


    /**** FOU *****/
    for(i=0;i<HAUTEUR_CASE-4;i++)
        for(j=0;j<LARGEUR_CASE;j++)
            d[2][i][j]=' ';

    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[2][i][j]=' ';
        d[2][i][LARGEUR_CASE-1-j]=' ';
    }
    d[2][i][j++]=220;
    d[2][i][j++]=219;
    d[2][i][j++]=219;
    d[2][i][j++]=223;
    d[2][i][j++]=' ';

    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[2][i][j]=' ';
        d[2][i][LARGEUR_CASE-1-j]=' ';
    }
    d[2][i][j++]=219;
    d[2][i][j++]=219;
    d[2][i][j++]=220;
    d[2][i][j++]=220;
    d[2][i][j++]=219;
    i++;

    for(j=0;j<(LARGEUR_CASE-3)/2;j++)
    {
        d[2][i][j]=' ';
        d[2][i][LARGEUR_CASE-1-j]=' ';
    }
    d[2][i][j++]=220;
    d[2][i][j++]=219;
    d[2][i][j++]=220;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[2][i][j]=' ';
        d[2][i][LARGEUR_CASE-1-j]=' ';
    }
    for(;j<(LARGEUR_CASE-5)/2+5;j++)
        d[2][i][j]=219;

 /**** TOUR *****/

    for(i=0;i<HAUTEUR_CASE-3;i++)
        for(j=0;j<LARGEUR_CASE;j++)
            d[3][i][j]=' ';
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[3][i][j]=' ';
        d[3][i][LARGEUR_CASE-1-j]=' ';
    }
    d[3][i][j++]=219;
    d[3][i][j++]=' ';
    d[3][i][j++]=219;
    d[3][i][j++]=' ';
    d[3][i][j++]=219;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[3][i][j]=' ';
        d[3][i][LARGEUR_CASE-1-j]=' ';
    }
    for(;j<(LARGEUR_CASE-5)/2+5;j++)
        d[3][i][j]=219;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[3][i][j]=' ';
        d[3][i][LARGEUR_CASE-1-j]=' ';
    }
    for(;j<(LARGEUR_CASE-5)/2+5;j++)
        d[3][i][j]=219;
    /**** ROI *****/

    for(i=0;i<HAUTEUR_CASE-5;i++)
        for(j=0;j<LARGEUR_CASE;j++)
            d[4][i][j]=' ';

    for(j=0;j<(LARGEUR_CASE-1)/2;j++)
    {
        d[4][i][j]=' ';
        d[4][i][LARGEUR_CASE-1-j]=' ';
    }
    d[4][i][j]=220;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[4][i][j]=' ';
        d[4][i][LARGEUR_CASE-1-j]=' ';
    }
    d[4][i][j++]=' ';
    d[4][i][j++]=223;
    d[4][i][j++]=219;
    d[4][i][j++]=223;
    d[4][i][j++]=' ';
    i++;
    for(j=0;j<(LARGEUR_CASE-3)/2;j++)
    {
        d[4][i][j]=' ';
        d[4][i][LARGEUR_CASE-1-j]=' ';
    }
    d[4][i][j++]=220;
    d[4][i][j++]=219;
    d[4][i][j++]=220;
    i++;
    for(j=0;j<(LARGEUR_CASE-3)/2;j++)
    {
        d[4][i][j]=' ';
        d[4][i][LARGEUR_CASE-1-j]=' ';
    }
    d[4][i][j++]=219;
    d[4][i][j++]=219;
    d[4][i][j++]=219;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[4][i][j]=' ';
        d[4][i][LARGEUR_CASE-1-j]=' ';
    }
    for(;j<(LARGEUR_CASE-5)/2+5;j++)
        d[4][i][j]=219;
    /**** DAME *****/

    for(i=0;i<HAUTEUR_CASE-4;i++)
        for(j=0;j<LARGEUR_CASE;j++)
            d[5][i][j]=' ';
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[5][i][j]=' ';
        d[5][i][LARGEUR_CASE-1-j]=' ';
    }
    d[5][i][j++]=219;
    d[5][i][j++]=220;
    d[5][i][j++]=219;
    d[5][i][j++]=220;
    d[5][i][j++]=219;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[5][i][j]=' ';
        d[5][i][LARGEUR_CASE-1-j]=' ';
    }
    d[5][i][j++]=220;
    d[5][i][j++]=219;
    d[5][i][j++]=219;
    d[5][i][j++]=219;
    d[5][i][j++]=220;
    i++;
    for(j=0;j<(LARGEUR_CASE-3)/2;j++)
    {
        d[5][i][j]=' ';
        d[5][i][LARGEUR_CASE-1-j]=' ';
    }
    for(;j<(LARGEUR_CASE-3)/2+3;j++)
        d[5][i][j]=219;
    i++;
    for(j=0;j<(LARGEUR_CASE-5)/2;j++)
    {
        d[5][i][j]=' ';
        d[5][i][LARGEUR_CASE-1-j]=' ';
    }
    for(;j<(LARGEUR_CASE-5)/2+5;j++)
        d[5][i][j]=219;
    i++;


}

void afficher_grille(piece* grid[][_SIZE])
{

    HANDLE  hConsoleOut;
    WORD    MyAttrib;
    int i,j;
    char abscisse = 'A';
    int ordonnee = 8;

    hConsoleOut = GetStdHandle( STD_OUTPUT_HANDLE );
    system("cls");


    for(i=0;i<_SIZE*HAUTEUR_CASE;i++)
    {
        for(j=0;j<_SIZE*LARGEUR_CASE;j++)
        {
            if((i/HAUTEUR_CASE)%2==0)
            {
                if(((i/HAUTEUR_CASE)*_SIZE+j/LARGEUR_CASE)%2==0){
                    MyAttrib=BACKGROUND_GREEN|BACKGROUND_RED|BACKGROUND_BLUE;
                }
                else
                    MyAttrib=0;
            }
            else
            {
                if(((i/HAUTEUR_CASE)*_SIZE+j/LARGEUR_CASE)%2==0){
                    MyAttrib=0;
                }
                else
                    MyAttrib=BACKGROUND_GREEN|BACKGROUND_RED|BACKGROUND_BLUE;
            }
            if(grid[i/HAUTEUR_CASE][j/LARGEUR_CASE]==NULL)
            {
                SetConsoleTextAttribute(hConsoleOut,MyAttrib);
                printf(" ");
            }
            else
            {
                if(grid[i/HAUTEUR_CASE][j/LARGEUR_CASE]->color==BLANC)
                    MyAttrib=MyAttrib|FOREGROUND_RED|FOREGROUND_GREEN;
                else
                    MyAttrib=MyAttrib|FOREGROUND_RED;
                SetConsoleTextAttribute(hConsoleOut,MyAttrib);
                printf("%c",dessin_piece[grid[i/HAUTEUR_CASE][j/LARGEUR_CASE]->type][i%HAUTEUR_CASE][j%LARGEUR_CASE]);
            }
       }
        SetConsoleTextAttribute(hConsoleOut,FOREGROUND_RED|FOREGROUND_GREEN|FOREGROUND_BLUE);
        if(i%HAUTEUR_CASE==HAUTEUR_CASE/2)
            printf("  %i",ordonnee--);
        printf("\n");

    }
    printf("\n");
    for(j=0;j<_SIZE*LARGEUR_CASE;j++)
    {
        if(j%LARGEUR_CASE==LARGEUR_CASE/2)
            printf("%c",abscisse++);
        else
            printf(" ");
    }
     printf("\n\n");
}

deplacement get_deplacement(char col1, int lig1,char col2, int lig2)
{
    position c1,c2;
    deplacement d;
    c1.colonne=col1-'A';
    c1.ligne = _SIZE-lig1;
    c2.colonne=col2-'A';
    c2.ligne = _SIZE-lig2;
    d.depart=c1;
    d.arrivee=c2;
    return d;
}
void deplacements_possibles(echiquier grid, position Cdonee, deplacement destin, couleur player_color, int* p)
{
    int ECHECpiece[8][8];
    int i, j;
    for(i=0;i<8;++i)
    {
        for(j=0;j<8;++j)
        {
            ECHECpiece[i][j]=0;
        }
    }
    int COLON_piece=Cdonee.colonne-'A';
    int LIGNE_piece=8-Cdonee.ligne;
    if(player_color==BLANC)
    {
    int a=NOIR;
    switch (grid[LIGNE_piece][COLON_piece]->type)
    {
    case PION:
            if(Cdonee.colonne=='A')
            {
                if(grid[LIGNE_piece-1][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if(LIGNE_piece==6)
                {
                if(grid[LIGNE_piece-2][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece]=1;
                }
                }
                if(grid[LIGNE_piece-1][COLON_piece+1]!=NULL)
                {
                if(grid[LIGNE_piece-1][COLON_piece+1]->color==a)
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                }
                if(grid[destin.arrivee.ligne][destin.arrivee.colonne]->type==PION)
                {
                if(LIGNE_piece==3)
                {
                    if((destin.depart.ligne==1)&&(destin.arrivee.ligne)==3)
                    {
                        if(destin.arrivee.colonne==COLON_piece+1)
                        {
                            ECHECpiece[LIGNE_piece-1][destin.arrivee.colonne]=1;
                        }
                    }
                }
                }
            }
            if(Cdonee.colonne=='H')
            {
                if(grid[LIGNE_piece-1][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if(LIGNE_piece==6)
                {
                if(grid[LIGNE_piece-2][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece]=1;
                }
                }
                if(grid[LIGNE_piece-1][COLON_piece-1]!=NULL&&grid[LIGNE_piece-1][COLON_piece-1]->color==a)
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if(grid[destin.arrivee.ligne][destin.arrivee.colonne]->type==PION)
                {
                if(LIGNE_piece==3)
                {
                    if((destin.depart.ligne==1)&&(destin.arrivee.ligne)==3)
                    {
                        if(destin.arrivee.colonne==COLON_piece-1)
                        {
                            ECHECpiece[LIGNE_piece-1][destin.arrivee.colonne]=1;
                        }
                    }
                }
                }
            }
            if((Cdonee.colonne!='A')&&(Cdonee.colonne!='H'))
            {
                if(grid[LIGNE_piece-1][COLON_piece-1]!=NULL&&grid[LIGNE_piece-1][COLON_piece-1]->color==a)
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if(grid[LIGNE_piece-1][COLON_piece+1]!=NULL&&grid[LIGNE_piece-1][COLON_piece+1]->color==a)
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if(grid[LIGNE_piece-1][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if(LIGNE_piece==6)
                {
                if(grid[LIGNE_piece-2][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece]=1;
                }
                }
                if(grid[destin.arrivee.ligne][destin.arrivee.colonne]->type==PION)
                {
                if(LIGNE_piece==3)
                {
                    if((destin.depart.ligne==1)&&(destin.arrivee.ligne)==3)
                    {
                        if((destin.arrivee.colonne==COLON_piece+1)||(destin.arrivee.colonne==COLON_piece-1))
                        {
                            ECHECpiece[LIGNE_piece-1][destin.arrivee.colonne]=1;
                        }
                    }
                }
                }
            }
        break;
    case CAVALIER:
        if(Cdonee.colonne=='A')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
            }

        }
        if(Cdonee.colonne=='B')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }

            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
        }
        if(Cdonee.colonne=='H')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
        }
        if(Cdonee.colonne=='G')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }

            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
        }
        if((Cdonee.colonne>='C')&&(Cdonee.colonne)<='F')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }

            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
        }
        break;
    case TOUR:
        for(i=1;i<'H'-Cdonee.colonne;++i)
        {
            if(grid[LIGNE_piece][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                break;
            }
        }
        for(i=1;i>'A'-Cdonee.colonne;--i)
        {
            if(grid[LIGNE_piece][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece][COLON_piece+i]->color==a)
                {
                    for(j=1;j>=i;--j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j>i;--j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                break;
            }
        }
        for(i=1;i<8-Cdonee.colonne;++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                break;
            }
        }
        for(i=1;i>1-Cdonee.colonne;--i)
        {
            if(grid[LIGNE_piece-i][COLON_piece]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece]->color==a)
                {
                    for(j=1;j>=i;--j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece]->color==player_color)
                {
                    for(j=1;j>i;--j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                break;
            }
        }
        break;
    case FOU:
        for(i=1;i<(('H'-Cdonee.colonne<Cdonee.ligne-1)?'H'-Cdonee.colonne:Cdonee.ligne-1);++i)
        {
            if(grid[LIGNE_piece+i][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece+i][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece+j][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece+j]=1;
                }
                break;
            }

        }
        for(i=1;i<(('H'-Cdonee.colonne<8-Cdonee.ligne)?'H'-Cdonee.colonne:8-Cdonee.ligne);++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece+j]=1;
                }
            }
            break;
        }
        for(i=1;i<((Cdonee.colonne-'A'<Cdonee.ligne-1)?Cdonee.colonne-'A':Cdonee.ligne-1);++i)
        {
            if(grid[LIGNE_piece+i][COLON_piece-i]!=NULL)
            {
                if(grid[LIGNE_piece+i][COLON_piece-i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece-j]=1;
                }
                if(grid[LIGNE_piece+i][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece-j]=1;
                }
            }
            break;
        }
        for(i=1;i<((Cdonee.colonne-'A'<8-Cdonee.ligne)?Cdonee.colonne-'A':8-Cdonee.ligne);++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece-i]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece-i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece-j]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece-j]=1;
                }
            }
            break;
        }
        break;
    case DAME:
        for(i=1;i<'H'-Cdonee.colonne;++i)
        {
            if(grid[LIGNE_piece][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                break;
            }
        }
        for(i=1;i>'A'-Cdonee.colonne;--i)
        {
            if(grid[LIGNE_piece][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece][COLON_piece+i]->color==a)
                {
                    for(j=1;j>=i;--j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j>i;--j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                break;
            }
        }
        for(i=1;i<8-Cdonee.colonne;++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                break;
            }
        }
        for(i=1;i>1-Cdonee.colonne;--i)
        {
            if(grid[LIGNE_piece-i][COLON_piece]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece]->color==a)
                {
                    for(j=1;j>=i;--j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece]->color==player_color)
                {
                    for(j=1;j>i;--j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                break;
            }
        }
        for(i=1;i<(('H'-Cdonee.colonne<Cdonee.ligne-1)?'H'-Cdonee.colonne:Cdonee.ligne-1);++i)
        {
            if(grid[LIGNE_piece+i][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece+i][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece+j][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece+j]=1;
                }
                break;
            }

        }
        for(i=1;i<(('H'-Cdonee.colonne<8-Cdonee.ligne)?'H'-Cdonee.colonne:8-Cdonee.ligne);++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece+j]=1;
                }
            }
            break;
        }
        for(i=1;i<((Cdonee.colonne-'A'<Cdonee.ligne-1)?Cdonee.colonne-'A':Cdonee.ligne-1);++i)
        {
            if(grid[LIGNE_piece+i][COLON_piece-i]!=NULL)
            {
                if(grid[LIGNE_piece+i][COLON_piece-i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece-j]=1;
                }
                if(grid[LIGNE_piece+i][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece-j]=1;
                }
            }
            break;
        }
        for(i=1;i<((Cdonee.colonne-'A'<8-Cdonee.ligne)?Cdonee.colonne-'A':8-Cdonee.ligne);++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece-i]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece-i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece-j]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece-j]=1;
                }
            }
            break;
        }
        break;
    case ROI:
        if(Cdonee.colonne=='A')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece-1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+1][COLON_piece+1]==NULL)||(grid[LIGNE_piece+1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece]==NULL)||(grid[LIGNE_piece+1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
            }
            if((Cdonee.ligne>=2)&&(Cdonee.ligne<=7))
            {
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece-1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
            }

        }
        if(Cdonee.colonne=='H')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+1][COLON_piece-1]==NULL)||(grid[LIGNE_piece+1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece]==NULL)&&(grid[LIGNE_piece+1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)&&(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
            }
            if((Cdonee.ligne>=2)&&(Cdonee.ligne<=7))
            {
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece+1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece+1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
            }
        }
        if((Cdonee.colonne>='B')&&(Cdonee.colonne)<='G')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+1][COLON_piece-1]==NULL)||(grid[LIGNE_piece+1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece]==NULL)||(grid[LIGNE_piece+1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
            }
            if((Cdonee.ligne>=2)||(Cdonee.ligne<=7))
            {
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece-1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+1]==NULL)||(grid[LIGNE_piece+1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece]==NULL)||(grid[LIGNE_piece+1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
            }
        }
        break;
    }
    }
    if(player_color==NOIR)
    {
    int a=BLANC;
    switch (grid[LIGNE_piece][COLON_piece]->type)
    {
    case PION:
            if(Cdonee.colonne=='A')
            {
                if(grid[LIGNE_piece+1][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if(LIGNE_piece==2)
                {
                if(grid[LIGNE_piece+2][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece]=1;
                }
                }
                if(grid[LIGNE_piece+1][COLON_piece+1]!=NULL)
                {
                if(grid[LIGNE_piece+1][COLON_piece+1]->color==a)
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
                }
                if(grid[destin.arrivee.ligne][destin.arrivee.colonne]->type==PION)
                {
                if(LIGNE_piece==4)
                {
                    if((destin.depart.ligne==6)&&(destin.arrivee.ligne)==4)
                    {
                        if(destin.arrivee.colonne==COLON_piece+1)
                        {
                            ECHECpiece[LIGNE_piece+1][destin.arrivee.colonne]=1;
                        }
                    }
                }
                }
            }
            if(Cdonee.colonne=='H')
            {
                if(grid[LIGNE_piece+1][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if(LIGNE_piece==2)
                {
                if(grid[LIGNE_piece+2][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece]=1;
                }
                }
                if(grid[LIGNE_piece+1][COLON_piece-1]!=NULL)
                {
                if(grid[LIGNE_piece+1][COLON_piece-1]->color==a)
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
                }
                if(grid[destin.arrivee.ligne][destin.arrivee.colonne]->type==PION)
                {
                if(LIGNE_piece==4)
                {
                    if((destin.depart.ligne==6)&&(destin.arrivee.ligne)==4)
                    {
                        if(destin.arrivee.colonne==COLON_piece-1)
                        {
                            ECHECpiece[LIGNE_piece+1][destin.arrivee.colonne]=1;
                        }
                    }
                }
                }
            }
            if((Cdonee.colonne!='A')&&(Cdonee.colonne!='H'))
            {
                if(grid[LIGNE_piece+1][COLON_piece-1]!=NULL&&grid[LIGNE_piece+1][COLON_piece-1]->color==a)
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
                if(grid[LIGNE_piece+1][COLON_piece+1]!=NULL&&grid[LIGNE_piece+1][COLON_piece+1]->color==a)
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
                if(grid[LIGNE_piece+1][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if(LIGNE_piece==1)
                {
                if(grid[LIGNE_piece+2][COLON_piece]==NULL)
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece]=1;
                }
                }
                if(grid[destin.arrivee.ligne][destin.arrivee.colonne]->type==PION)
                {
                if(LIGNE_piece==4)
                {
                    if((destin.depart.ligne==6)&&(destin.arrivee.ligne)==4)
                    {
                        if((destin.arrivee.colonne==COLON_piece+1)||(destin.arrivee.colonne==COLON_piece-1))
                        {
                            ECHECpiece[LIGNE_piece+1][destin.arrivee.colonne]=1;
                        }
                    }
                }
                }
            }
        break;
    case CAVALIER:
        if(Cdonee.colonne=='A')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
            }

        }
        if(Cdonee.colonne=='B')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }

            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
        }
        if(Cdonee.colonne=='H')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
        }
        if(Cdonee.colonne=='G')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }

            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
        }
        if((Cdonee.colonne>='C')&&(Cdonee.colonne)<='F')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==2)
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }

            }
            if(Cdonee.ligne==7)
            {
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
            }
            if((Cdonee.ligne>=3)&&(Cdonee.ligne<=6))
            {
                if((grid[LIGNE_piece-2][COLON_piece-1]==NULL)||(grid[LIGNE_piece-2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-2][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+2]==NULL)||(grid[LIGNE_piece-1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-2]==NULL)||(grid[LIGNE_piece-1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-2]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece-1]==NULL)||(grid[LIGNE_piece+2][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+2][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+2][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+2]==NULL)||(grid[LIGNE_piece+1][COLON_piece+2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+2]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-2]==NULL)||(grid[LIGNE_piece+1][COLON_piece-2]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-2]=1;
                }
            }
        }
        break;
    case TOUR:
        for(i=1;i<'H'-Cdonee.colonne;++i)
        {
            if(grid[LIGNE_piece][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                break;
            }
        }
        for(i=1;i>'A'-Cdonee.colonne;--i)
        {
            if(grid[LIGNE_piece][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece][COLON_piece+i]->color==a)
                {
                    for(j=1;j>=i;--j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j>i;--j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                break;
            }
        }
        for(i=1;i<8-Cdonee.colonne;++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                break;
            }
        }
        for(i=1;i>1-Cdonee.colonne;--i)
        {
            if(grid[LIGNE_piece-i][COLON_piece]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece]->color==a)
                {
                    for(j=1;j>=i;--j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece]->color==player_color)
                {
                    for(j=1;j>i;--j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                break;
            }
        }
        break;
    case FOU:
        for(i=1;i<(('H'-Cdonee.colonne<Cdonee.ligne-1)?'H'-Cdonee.colonne:Cdonee.ligne-1);++i)
        {
            if(grid[LIGNE_piece+i][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece+i][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece+j][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece+j]=1;
                }
                break;
            }

        }
        for(i=1;i<(('H'-Cdonee.colonne<8-Cdonee.ligne)?'H'-Cdonee.colonne:8-Cdonee.ligne);++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece+j]=1;
                }
            }
            break;
        }
        for(i=1;i<((Cdonee.colonne-'A'<Cdonee.ligne-1)?Cdonee.colonne-'A':Cdonee.ligne-1);++i)
        {
            if(grid[LIGNE_piece+i][COLON_piece-i]!=NULL)
            {
                if(grid[LIGNE_piece+i][COLON_piece-i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece-j]=1;
                }
                if(grid[LIGNE_piece+i][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece-j]=1;
                }
            }
            break;
        }
        for(i=1;i<((Cdonee.colonne-'A'<8-Cdonee.ligne)?Cdonee.colonne-'A':8-Cdonee.ligne);++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece-i]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece-i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece-j]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece-j]=1;
                }
            }
            break;
        }
        break;
    case DAME:
        for(i=1;i<'H'-Cdonee.colonne;++i)
        {
            if(grid[LIGNE_piece][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                break;
            }
        }
        for(i=1;i>'A'-Cdonee.colonne;--i)
        {
            if(grid[LIGNE_piece][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece][COLON_piece+i]->color==a)
                {
                    for(j=1;j>=i;--j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j>i;--j)
                        ECHECpiece[LIGNE_piece][COLON_piece+j]=1;
                }
                break;
            }
        }
        for(i=1;i<8-Cdonee.colonne;++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                break;
            }
        }
        for(i=1;i>1-Cdonee.colonne;--i)
        {
            if(grid[LIGNE_piece-i][COLON_piece]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece]->color==a)
                {
                    for(j=1;j>=i;--j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece]->color==player_color)
                {
                    for(j=1;j>i;--j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece]=1;
                }
                break;
            }
        }
        for(i=1;i<(('H'-Cdonee.colonne<Cdonee.ligne-1)?'H'-Cdonee.colonne:Cdonee.ligne-1);++i)
        {
            if(grid[LIGNE_piece+i][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece+i][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece+j][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece+j]=1;
                }
                break;
            }

        }
        for(i=1;i<(('H'-Cdonee.colonne<8-Cdonee.ligne)?'H'-Cdonee.colonne:8-Cdonee.ligne);++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece+i]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece+i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece+j]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece+i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece+j]=1;
                }
            }
            break;
        }
        for(i=1;i<((Cdonee.colonne-'A'<Cdonee.ligne-1)?Cdonee.colonne-'A':Cdonee.ligne-1);++i)
        {
            if(grid[LIGNE_piece+i][COLON_piece-i]!=NULL)
            {
                if(grid[LIGNE_piece+i][COLON_piece-i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece-j]=1;
                }
                if(grid[LIGNE_piece+i][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece+j][COLON_piece-j]=1;
                }
            }
            break;
        }
        for(i=1;i<((Cdonee.colonne-'A'<8-Cdonee.ligne)?Cdonee.colonne-'A':8-Cdonee.ligne);++i)
        {
            if(grid[LIGNE_piece-i][COLON_piece-i]!=NULL)
            {
                if(grid[LIGNE_piece-i][COLON_piece-i]->color==a)
                {
                    for(j=1;j<=i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece-j]=1;
                }
                if(grid[LIGNE_piece-i][COLON_piece-i]->color==player_color)
                {
                    for(j=1;j<i;++j)
                        ECHECpiece[LIGNE_piece-j][COLON_piece-j]=1;
                }
            }
            break;
        }
        break;
    case ROI:
        if(Cdonee.colonne=='A')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece-1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+1][COLON_piece+1]==NULL)||(grid[LIGNE_piece+1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece]==NULL)||(grid[LIGNE_piece+1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
            }
            if((Cdonee.ligne>=2)&&(Cdonee.ligne<=7))
            {
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece-1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
            }

        }
        if(Cdonee.colonne=='H')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+1][COLON_piece-1]==NULL)||(grid[LIGNE_piece+1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece]==NULL)&&(grid[LIGNE_piece+1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)&&(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
            }
            if((Cdonee.ligne>=2)&&(Cdonee.ligne<=7))
            {
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece+1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece+1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
            }
        }
        if((Cdonee.colonne>='B')&&(Cdonee.colonne)<='G')
        {
            if(Cdonee.ligne==1)
            {
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece-2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
            }
            if(Cdonee.ligne==8)
            {
                if((grid[LIGNE_piece+1][COLON_piece-1]==NULL)||(grid[LIGNE_piece+1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+1]==NULL)||(grid[LIGNE_piece+2][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece]==NULL)||(grid[LIGNE_piece+1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
            }
            if((Cdonee.ligne>=2)||(Cdonee.ligne<=7))
            {
                if((grid[LIGNE_piece-1][COLON_piece-1]==NULL)||(grid[LIGNE_piece-1][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece+1]==NULL)||(grid[LIGNE_piece-1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece-1][COLON_piece]==NULL)||(grid[LIGNE_piece-1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece-1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece-1]=1;
                }
                if((grid[LIGNE_piece][COLON_piece+1]==NULL)||(grid[LIGNE_piece][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece+1]==NULL)||(grid[LIGNE_piece+1][COLON_piece+1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece+1]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece]==NULL)||(grid[LIGNE_piece+1][COLON_piece]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece]=1;
                }
                if((grid[LIGNE_piece+1][COLON_piece-1]==NULL)||(grid[LIGNE_piece][COLON_piece-1]->color==a))
                {
                    ECHECpiece[LIGNE_piece+1][COLON_piece-1]=1;
                }
            }
        }
        break;
    }
    }
    for(i=0;i<8;++i)
    {
        printf("%d   ", 8-i);
        for(j=0;j<8;++j)
        {
        printf("%d   ", ECHECpiece[i][j]);
        }
        printf("\n");
    }
    printf("    A   B   C   D   E   F   G   H\n");
    for(i=0;i<8;++i)
    {
        for(j=0;j<8;++j)
        {
            *(p+i*8+j)=ECHECpiece[i][j];
        }
    }
}
deplacement saisie_deplacement(echiquier grid, couleur player_color, deplacement destin)
{
    position Cdonee;
    int ok = 0;
    deplacement d1;
    char col,col2;
    int lig,lig2;
    while(ok==0)
    {
        if(player_color==NOIR){
            printf("Phrase de Jeu: ROUGE\n");
        }else if(player_color==BLANC){
            printf("Phrase de Jeu: JAUNE\n");
        }
        fflush(stdin);
        printf("INNPUT:...");
        scanf(" %c%i",&col,&lig);
        if(col>'H' || col < 'A' || lig <1 || lig>8 )
            printf("Coordonnees non valides. Recommencez\n");
        else
        {
            d1.depart.colonne=col-'A';
            d1.depart.ligne = _SIZE-lig;
            Cdonee.colonne=col;
            Cdonee.ligne=lig;
            if(grid[d1.depart.ligne][d1.depart.colonne]==NULL)
                printf("Pas de piece ici. Recommencez\n");
            else if (grid[d1.depart.ligne][d1.depart.colonne]->color!= player_color)
                 printf("Cette piece n'est pas la votre. Recommencez\n");
            else
            {
                int *destin_alter;
                int a02[8][8];
                destin_alter=(int*) a02;
                deplacements_possibles(grid, Cdonee, destin, player_color, destin_alter);
                printf("Move ?");
                flag_zone: scanf(" %c%i",&col2,&lig2);
                if(col2>'H' || col2 < 'A' || lig2 <1 || lig2>8 )
                    printf("Coordonnees non valides. Recommencez\n");
                else
                {
                    if(a02[8-lig2][col2-'A']!=0)
                    {
                    d1 = get_deplacement(col,lig,col2,lig2);
                    ok=1;
                    }
                    else
                    {
                        printf("Votre move est impossible\nResasissez votre move\n");
                        goto flag_zone;
                    }
                }
            }
        }
    }
    return d1;
}
